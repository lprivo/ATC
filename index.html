<!DOCTYPE html>
<html>
  <head>
    <title>Privo ATC Simulator</title>
    <meta charset="utf-8" />
    <meta http-equiv="Cache-Control" content="no-cache" />
    <link rel="stylesheet" type="text/css" href="./src/theme/atc.css" />
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
    <link rel="icon" href="./src/Images/ATC_logo_icon.png" />
  </head>
  <body>
    <div id="startModal" class="modal">
      <div class="modal-content">
        <form id="startform" method="post" action="">
          <table>
            <tr>
              <td>
                <select id="Airports">
                  <option hidden="true">Please select an airport</option>
                  <option value="LHBP" selected="selected"
                    >Budapest - Liszt Ferenc</option
                  >
                  <option value="EGLL">London - Heathrow</option>
                  <option value="EPWA">Warsaw - Chopin</option>
                  <option value="KSEA">Seattle-Tacoma Intl.</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>
                <select id="Difficulty">
                  <option hidden="true">Please select a difficulty</option>
                  <option value="4000">Easy</option>
                  <option value="3000" selected="selected">Normal</option>
                  <option value="2000">Rush hour</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>
                <select id="GameMode">
                  <option hidden="true">Please select a game mode</option>
                  <option value=".5" selected="selected"
                    >Arrivals & Departures</option
                  >
                  <option value="1.0">Arrivals only</option>
                  <option value="0">Departures only</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>
                <input
                  type="button"
                  id="startbutton"
                  value="Start simulation"
                  onclick="setOpts()"
                  autofocus
                />
              </td>
            </tr>
          </table>
        </form>
      </div>
    </div>

    <div id="endModal" class="endModal">
      <div class="endModal-content">
        <form id="endform" method="post" action="index.html">
          <table id="endTable">
            <tr>
              <td class="endTd">Thanks for trying out my ATC simulator!</td>
            </tr>
            <tr>
              <td class="endTd">Your final results are below:</td>
            </tr>
            <tr>
              <td class="endTd">Successful landings:</td>
              <td id="successfulLandings" class="endTd2"></td>
            </tr>
            <tr>
              <td class="endTd">Successful handoffs:</td>
              <td id="successfulHandoffs" class="endTd2"></td>
            </tr>
            <tr>
              <td class="endTd">Missed approaches:</td>
              <td id="missedApproaches" class="endTd2"></td>
            </tr>
            <tr>
              <td class="endTd">Improper exits:</td>
              <td id="improperExits" class="endTd2"></td>
            </tr>
            <tr>
              <td class="endTd">Separation violation:</td>
              <td id="sepViolation" class="endTd2"></td>
              <td class="endTd2">sec</td>
            </tr>
            <tr>
              <td class="returnButton">
                <!-- <input type="submit" id="returnButton" value="Back to Start Page" autofocus /> -->
              </td>
            </tr>
          </table>
        </form>
        <div id="backbtn"><a href="index.html">Back to Start Page</a></div>
      </div>
    </div>

    <div id="controlPanel">
      <div class="panels">
        <div class="pad3">
          <div id="psFrame"></div>
          <div class="block4"></div>
        </div>
      </div>
      <div class="panels">
        <div class="pad3">
          <div id="titleDiv">
            <h5 id="titleAirport">Airport</h5>
            <h6 id="titleCode">ICAO: | IATA:</h6>
            <h6 id="titleElev">Elevation:</h6>
          </div>
          <div class="block10"></div>
          <div>
            <input
              type="text"
              id="instructionText"
              placeholder="instructions"
              onfocus="txtfocus=true"
              onblur="txtfocus=false"
              autocomplete="off"
            />
          </div>
          <div class="block4"></div>
          <div>
            <input
              type="button"
              id="transmitBtn"
              class="btns"
              value="Transmit"
              onClick="doInstruction()"
            />
            <input
              type="button"
              id="pauseBtn"
              class="btns"
              value="Pause"
              onClick="fnPausing()"
            />
          </div>
          <div class="block4"></div>
          <div><textarea readonly id="console"></textarea></div>
          <div class="block4"></div>
          <div>
            <input
              type="button"
              id="helpBtn"
              class="btns"
              value="Help"
              onClick="showInfoscreen()"
            />
            <input
              type="button"
              id="statsBtn"
              class="btns"
              value="Stats"
              onClick="showStatscreen()"
            />
          </div>
          <div class="block4"></div>
          <div>
            <input
              type="button"
              id="endBtn"
              value="End Simulation"
              onClick="endSim()"
            />
          </div>
        </div>
      </div>
      <div class="block4"></div>
      <div>
        <div class="pad3">
          <textarea readonly id="infoScreen">

	Commands consist of 2-5 parts divided by space(s).
First part is the flight number (e.g. "AA001")
Followed by the clearance type and its parameters as below:

- "A" to change ALTITUDE followed by the required altitude in 100 feet beetween 20 and 400. (e.g.: AA001 A 40)

- "S" to change SPEED followed by the required speed in 10 knots between 16 and 30. (e.g.: AA001 S 20)

- "H" to change HEADING followed by either the required heading direction in degrees (1-360), where 360 is North, 180 is South (e.g.: AA001 H 150) or the destination navigation object. (e.g.: B H wOD)
 For instructing an aircraft to start holding procedure at a navigation object write an additional "HP" after the navigation object code. (e.g.: AA001 H WOD HP)
 
- "L" to clear an aircraft for LANDING followed by the runway ID. (e.g.: AA001 L 27L)
 Landing clearance must only be given when an aircraft's actual heading is within 20 degrees that of the chosen runway angle (its ID * 10) and when the aircraft is not higher than 4000 feet!
 
- "T" to clear an aircraft for TAKE-OFF. (e.g.: AA001 T 27L WOD 80)
 Following "T" type the runway intended for take-off then the exit navigation object shown on the flightstrip and finally an hand-over altitude.
 (Note: In case the aircraft exits anywhere else other than the nav. object indicated it will count as an improper exit.)

- "W" to clear an aircraft for LINING-UP AND WAITING on the runway before take-off. (e.g.: AA001 W 27L WOD 80)
 This option is mainly for busy periods. Similarly to the take-off command, after "W" type the runway intended for take-off then the exit navigation object indicated and the hand-over altitude.
 When an aircraft is given a waiting clearance already, for take-off clearance only type the flight ID and "T" as the exit parameters will be remembered. (e.g.: AA001 T)
 
	Additional commands:

- Press "P" to PAUSE/RESUME the simulation.

- Type "EXIT" or press "End Simulaton" button to exit the game. Your final statistics will be shown.
	
	Notes: Aircraft need to be separated by at least 3NM laterally and 1000 feet vertically.
			</textarea
          >
          <div id="statScreen"></div>
        </div>
      </div>
    </div>
    <canvas id="myCanvas"></canvas>
    <script type="text/javascript" src="SimControl.js"></script>
    <script type="text/javascript" src="init_Airports.js"></script>
    <script type="text/javascript" src="DrawObjects.js"></script>
    <script type="text/javascript" src="UserInstructions.js"></script>
    <script type="text/javascript" src="AircraftMovements.js"></script>
    <script type="text/javascript" src="FlightModes.js"></script>
    <script type="text/javascript">
      var modal = document.getElementById("startModal");
      var cW = window.innerWidth - 310;
      var cH = window.innerHeight; // cH/cW=.583
      var cHW = cW * 0.6;
      var planeNR = 0; // body canvas - style="background: #103848"
      var planes = [];
      var runways = [];
      var airlnrCode = []; //operating airliners' list
      var airlnrDistr = []; //operating airliners's distribution - main operator + 4 groups by no. of aircrafts
      var destName;
      var entryPts = [];
      //var consoleText = document.getElementById('console').value;
      var userCommand; // = document.getElementById("instructionText").value;
      var splitCommand = [];
      var pausing = false;
      var resid;
      var entryAlt = [50, 50, 60, 60, 60, 70, 70, 70, 70, 80, 80, 80];
      var navObjects = [];
      var successfulLandings = 0;
      var successfulHandoffs = 0;
      var improperExits = 0;
      var missedApproaches = 0;
      var sepViolation = 0;
      var canvas = document.getElementById("myCanvas");
      var context = canvas.getContext("2d");
      var psFrame = document.getElementById("psFrame");
      var selMode;

      window.requestAnimFrame = (function(callback) {
        return (
          window.requestAnimationFrame ||
          window.webkitRequestAnimationFrame ||
          window.mozRequestAnimationFrame ||
          window.oRequestAnimationFrame ||
          window.msRequestAnimationFrame ||
          function(callback) {
            window.setTimeout(callback, 1000);
          }
        );
      })();

      function screenSize() {
        canvas.width = cW;
        canvas.height = cH;
        return;
      }

      window.addEventListener("resize", screenSize);

      function promptInvalidCommTest() {
        document.getElementById("console").value =
          "TEST Invalid Command!\n" + document.getElementById("console").value;
        document.getElementById("instructionText").value = "";
        resid = -1;
        return;
      }

      window.onload = function() {
        screenSize();
        modal.style.display = "block";
        document.getElementById("instructionText").focus();
        document.getElementById("console").value =
          "Welcome to Privo-ATC!" + document.getElementById("console").value;
        document.getElementById("instructionText").value = "";
        return;
      };
    </script>
  </body>
</html>
